<!DOCTYPE html>
<html lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="author" content="myndtt">



<meta name="description" content="0x00.å‰è¨€æƒ³å­¦ä¹ pythonçš„flaskï¼Œçœ‹äº†ã€ŠFlaskWebå¼€å‘ï¼šåŸºäºPythonçš„Webåº”ç”¨å¼€å‘å®æˆ˜ã€‹è¿™æœ¬ä¹¦ï¼Œè§‰å¾—å¾ˆOKğŸ‘Œã€‚ä¹‹å‰å½­å¸ˆå…„åˆ†æè¿‡flask v0.1çš„æºç ï¼Œå¬è¯´ä»£ç ä¸é•¿ï¼ŒåŠ ä¹‹ç½‘ä¸Šè§£é‡Šç”šå¤šï¼Œæ‰€ä»¥è‡ªå·±ä¹Ÿæƒ³çœ‹çœ‹ï¼Œå°±å…¶æœ¬èº«ï¼Œæœ¬æ–‡æ— æ„ä¹‰ï¼Œæœ‰é”™è¯¯æ›´æ˜¯å¯èƒ½ï¼Œåªæ˜¯è®°å½•è€Œå·²ã€‚ 0x01.è·å–ç¬¬ä¸€æ­¥è·å–git clone https://github.com/pallets/flask.git">
<meta name="keywords" content="python,è®°å½•,flask">
<meta property="og:type" content="article">
<meta property="og:title" content="flask v0.1æºç ç®€å•åˆ†æ">
<meta property="og:url" content="https://myndtt.github.io/2018/01/22/flask-v0-1æºç ç®€å•åˆ†æ/index.html">
<meta property="og:site_name" content="myndtt || blog">
<meta property="og:description" content="0x00.å‰è¨€æƒ³å­¦ä¹ pythonçš„flaskï¼Œçœ‹äº†ã€ŠFlaskWebå¼€å‘ï¼šåŸºäºPythonçš„Webåº”ç”¨å¼€å‘å®æˆ˜ã€‹è¿™æœ¬ä¹¦ï¼Œè§‰å¾—å¾ˆOKğŸ‘Œã€‚ä¹‹å‰å½­å¸ˆå…„åˆ†æè¿‡flask v0.1çš„æºç ï¼Œå¬è¯´ä»£ç ä¸é•¿ï¼ŒåŠ ä¹‹ç½‘ä¸Šè§£é‡Šç”šå¤šï¼Œæ‰€ä»¥è‡ªå·±ä¹Ÿæƒ³çœ‹çœ‹ï¼Œå°±å…¶æœ¬èº«ï¼Œæœ¬æ–‡æ— æ„ä¹‰ï¼Œæœ‰é”™è¯¯æ›´æ˜¯å¯èƒ½ï¼Œåªæ˜¯è®°å½•è€Œå·²ã€‚ 0x01.è·å–ç¬¬ä¸€æ­¥è·å–git clone https://github.com/pallets/flask.git">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://myndtt.github.io/images/54.png">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1563354-26e27df8f32e9d55.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/545">
<meta property="og:image" content="http://myndtt.github.io/images/55.png">
<meta property="og:image" content="http://myndtt.github.io/images/56.png">
<meta property="og:updated_time" content="2019-09-22T05:04:46.309Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="flask v0.1æºç ç®€å•åˆ†æ">
<meta name="twitter:description" content="0x00.å‰è¨€æƒ³å­¦ä¹ pythonçš„flaskï¼Œçœ‹äº†ã€ŠFlaskWebå¼€å‘ï¼šåŸºäºPythonçš„Webåº”ç”¨å¼€å‘å®æˆ˜ã€‹è¿™æœ¬ä¹¦ï¼Œè§‰å¾—å¾ˆOKğŸ‘Œã€‚ä¹‹å‰å½­å¸ˆå…„åˆ†æè¿‡flask v0.1çš„æºç ï¼Œå¬è¯´ä»£ç ä¸é•¿ï¼ŒåŠ ä¹‹ç½‘ä¸Šè§£é‡Šç”šå¤šï¼Œæ‰€ä»¥è‡ªå·±ä¹Ÿæƒ³çœ‹çœ‹ï¼Œå°±å…¶æœ¬èº«ï¼Œæœ¬æ–‡æ— æ„ä¹‰ï¼Œæœ‰é”™è¯¯æ›´æ˜¯å¯èƒ½ï¼Œåªæ˜¯è®°å½•è€Œå·²ã€‚ 0x01.è·å–ç¬¬ä¸€æ­¥è·å–git clone https://github.com/pallets/flask.git">
<meta name="twitter:image" content="http://myndtt.github.io/images/54.png">

<link rel="apple-touch-icon" href="/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="myndtt || blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/images/1.jpg">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>flask v0.1æºç ç®€å•åˆ†æ | myndtt || blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: false
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/images/1.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">myndtt</a></h1>
        </hgroup>

        
        <p class="header-subtitle">ä»å¤©å ‚åˆ°å½¼ç•Œ è·¯è¿‡äººé—´</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>èœå•</li>
                        <li>æ ‡ç­¾</li>
                        
                        <li>å‹æƒ…é“¾æ¥</li>
                        
                        
                        <li>å…³äºæˆ‘</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">ä¸»é¡µ</a></li>
                        
                            <li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                        
                            <li><a href="/tags/">æ ‡ç­¾äº‘</a></li>
                        
                            <li><a href="/about/">å…³äºæˆ‘</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:admin@myndtt.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="https://github.com/myndtt" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/audit/">audit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glance/">glance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keystone/">keystone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nova/">nova</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openstack/">openstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scrapy/">scrapy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sniperoj/">sniperoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqli/">sqli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlid/">sqlid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å­¦ä¹ /">å­¦ä¹ </a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å®éªŒå§/">å®éªŒå§</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç‚¹æ»´/">ç‚¹æ»´</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç¼–ç¨‹/">ç¼–ç¨‹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/èƒ¡è¯´å…«é“/">èƒ¡è¯´å…«é“</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è®°å½•/">è®°å½•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è®°å½•-hadoop/">è®°å½• hadoop</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://www.sec-wiki.com/">sec-wiki</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.myh0st.cn/">myh0st</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://www.leavesongs.com/">å¤§Pç¥</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.laruence.com/">é£ç¥(é£é›ªä¹‹éš…)</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.yulegeyu.com/">é›¨å¸ˆå‚…</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://momomoxiaoxi.com/">å°è¥¿å¸ˆå‚…</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://lorexxar.cn/">LoRexxar</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.yqxiaojunjie.com/">ä¹æ¸…å¸ˆå‚…</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://0x48.pw/">Hcamael</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://chybeta.github.io/">Chybeta</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/lcamry">lcamry</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://www.lynahex.com/">lynahex</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/iamstudy/">æŸ æª¬å¸ˆå‚…</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">å°èœé¸¡ å¥‹æ–—ä¸­...</div>
                </section>
                
            </div>
        </div>
    </header>   
   	 <div id="circle"></div>
		<div id="circletext"><strong style="font-size: 12px;"><a>è¯ä¸è¾¾æ„</a></strong></div>
		<div id="circle1"></div>             
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="å›åˆ°ä¸»é¡µ">myndtt</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/images/1.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="å›åˆ°ä¸»é¡µ">myndtt</a></h1>
            </hgroup>
            
            <p class="header-subtitle">ä»å¤©å ‚åˆ°å½¼ç•Œ è·¯è¿‡äººé—´</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">ä¸»é¡µ</a></li>
                
                    <li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                
                    <li><a href="/tags/">æ ‡ç­¾äº‘</a></li>
                
                    <li><a href="/about/">å…³äºæˆ‘</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:admin@myndtt.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/myndtt" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="æ ‡ç­¾" friends="å‹æƒ…é“¾æ¥" about="å…³äºæˆ‘"/>
</nav>
      <div class="body-wrap"><article id="post-flask-v0-1æºç ç®€å•åˆ†æ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/01/22/flask-v0-1æºç ç®€å•åˆ†æ/" class="article-date">
      <time datetime="2018-01-22T05:50:17.000Z" itemprop="datePublished">2018-01-22</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      flask v0.1æºç ç®€å•åˆ†æ
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flask/">flask</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/è®°å½•/">è®°å½•</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00.å‰è¨€"></a>0x00.å‰è¨€</h2><p>æƒ³å­¦ä¹ pythonçš„flaskï¼Œçœ‹äº†ã€ŠFlaskWebå¼€å‘ï¼šåŸºäºPythonçš„Webåº”ç”¨å¼€å‘å®æˆ˜ã€‹è¿™æœ¬ä¹¦ï¼Œè§‰å¾—å¾ˆOKğŸ‘Œã€‚ä¹‹å‰å½­å¸ˆå…„åˆ†æè¿‡flask v0.1çš„æºç ï¼Œå¬è¯´ä»£ç ä¸é•¿ï¼ŒåŠ ä¹‹ç½‘ä¸Šè§£é‡Šç”šå¤šï¼Œæ‰€ä»¥è‡ªå·±ä¹Ÿæƒ³çœ‹çœ‹ï¼Œå°±å…¶æœ¬èº«ï¼Œæœ¬æ–‡æ— æ„ä¹‰ï¼Œæœ‰é”™è¯¯æ›´æ˜¯å¯èƒ½ï¼Œåªæ˜¯è®°å½•è€Œå·²ã€‚</p>
<h2 id="0x01-è·å–"><a href="#0x01-è·å–" class="headerlink" title="0x01.è·å–"></a>0x01.è·å–</h2><p>ç¬¬ä¸€æ­¥è·å–<code>git clone https://github.com/pallets/flask.git</code>,è¿™æ˜¯æœ€æ–°ç‰ˆæœ¬çš„</p>
<p>ç¬¬äºŒæ­¥ <code>git tag</code>çœ‹ç‰ˆæœ¬</p>
<p>ç¬¬ä¸‰æ­¥<code>git reset --hard xx</code>å›é€€åˆ°å¯¹åº”ç‰ˆæœ¬</p>
<p>æœ€åæ˜¯è¿™æ ·</p>
<p><img src="http://myndtt.github.io/images/54.png" alt="54"></p>
<p>ä¸»è¦å†…å®¹åœ¨flask.pyæ–‡ä»¶é‡Œé¢</p>
<a id="more"></a>
<h2 id="0x02-ç®€è¦åˆ†æ"><a href="#0x02-ç®€è¦åˆ†æ" class="headerlink" title="0x02.ç®€è¦åˆ†æ"></a>0x02.ç®€è¦åˆ†æ</h2><h3 id="1-åŒ…"><a href="#1-åŒ…" class="headerlink" title="1.åŒ…"></a>1.åŒ…</h3><p>flask.pyå¯¼å…¥çš„åŒ…æƒ…å†µ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> with_statement</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> local</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Environment, PackageLoader, FileSystemLoader</span><br><span class="line"><span class="keyword">from</span> werkzeug <span class="keyword">import</span> Request <span class="keyword">as</span> RequestBase, Response <span class="keyword">as</span> ResponseBase, \</span><br><span class="line">     LocalStack, LocalProxy, create_environ, cached_property, \</span><br><span class="line">     SharedDataMiddleware</span><br><span class="line"><span class="keyword">from</span> werkzeug.routing <span class="keyword">import</span> Map, Rule</span><br><span class="line"><span class="keyword">from</span> werkzeug.exceptions <span class="keyword">import</span> HTTPException, InternalServerError</span><br><span class="line"><span class="keyword">from</span> werkzeug.contrib.securecookie <span class="keyword">import</span> SecureCookie</span><br><span class="line"></span><br><span class="line"><span class="comment"># utilities we import from Werkzeug and Jinja2 that are unused</span></span><br><span class="line"><span class="comment"># in the module but are exported as public interface.</span></span><br><span class="line"><span class="keyword">from</span> werkzeug <span class="keyword">import</span> abort, redirect</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Markup, escape</span><br></pre></td></tr></table></figure>
<p>Werkzeugæ˜¯<a href="https://baike.baidu.com/item/Python" target="_blank" rel="noopener">Python</a>çš„<a href="https://baike.baidu.com/item/WSGI" target="_blank" rel="noopener">WSGI</a>è§„èŒƒçš„å®ç”¨å‡½æ•°åº“ï¼Œè€Œå¯¹äºWSGI,å»–å…ˆç”Ÿè§£é‡Šçš„å¾ˆå¥½å•Š<a href="https://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001386832689740b04430a98f614b6da89da2157ea3efe2000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001386832689740b04430a98f614b6da89da2157ea3efe2000</a></p>
<p>ç›—ä¸€å¼ ç®€ä¹¦çš„å›¾</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1563354-26e27df8f32e9d55.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/545" alt="55"></p>
<p>è€Œjinja2æ˜¯flaskå…¶é»˜è®¤çš„é¡µé¢æ¨¡ç‰ˆï¼Œå…¶æ ¼å¼æœ‰ç‚¹åƒæœ€åˆçš„å°†javaä»£ç å†™åœ¨jspé¡µé¢ä¸­â€¦</p>
<h3 id="2-ä¸Šä¸‹æ–‡"><a href="#2-ä¸Šä¸‹æ–‡" class="headerlink" title="2.ä¸Šä¸‹æ–‡"></a>2.ä¸Šä¸‹æ–‡</h3><p>flask.pyæœ€ä¸‹é¢æ˜¯è¿™å‡ è¡Œï¼Œè¦çœ‹æ‡‚flaskéœ€è¦äº†è§£å…¶ä¸Šä¸‹æ–‡æœºåˆ¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_request_ctx_stack = LocalStack()<span class="comment">#å»ºç«‹requestæ ˆ</span></span><br><span class="line">current_app = LocalProxy(<span class="keyword">lambda</span>: _request_ctx_stack.top.app)<span class="comment">#æ ˆå½“å‰app</span></span><br><span class="line">request = LocalProxy(<span class="keyword">lambda</span>: _request_ctx_stack.top.request)<span class="comment">#æ ˆå½“å‰request</span></span><br><span class="line">session = LocalProxy(<span class="keyword">lambda</span>: _request_ctx_stack.top.session)<span class="comment">#æ ˆå½“å‰session</span></span><br><span class="line">g = LocalProxy(<span class="keyword">lambda</span>: _request_ctx_stack.top.g)<span class="comment">#å½“æ ˆå‰g</span></span><br></pre></td></tr></table></figure>
<p>ä¹¦ä¸­æœ‰æåˆ°</p>
<p><img src="http://myndtt.github.io/images/55.png" alt="55"></p>
<p>å¯¹äºä¸Šä¸‹æ–‡çš„è§£é‡Šæ›´æœ‰<a href="https://blog.tonyseek.com/post/the-context-mechanism-of-flask/" target="_blank" rel="noopener">https://blog.tonyseek.com/post/the-context-mechanism-of-flask/</a></p>
<p>è§£é‡Šçš„å¾ˆå¥½ã€‚</p>
<h3 id="3-ç®€å•æµç¨‹"><a href="#3-ç®€å•æµç¨‹" class="headerlink" title="3.ç®€å•æµç¨‹"></a>3.ç®€å•æµç¨‹</h3><p>ä¸‹é¢ä¸€å¤§ä¸²å…¶å®ä¸»è¦ä¸ºäº†è§£é‡Šä¸Šé—¨é‚£å¼ å›¾</p>
<h4 id="ä¸€-app-Flask-name"><a href="#ä¸€-app-Flask-name" class="headerlink" title="ä¸€.app=Flask(__name__)"></a>ä¸€.<code>app=Flask(__name__)</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¨‹åºå…¥å£ å»ºç«‹appå®ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flask</span><span class="params">(object)</span>:</span></span><br></pre></td></tr></table></figure>
<p>å¹¶ä¸”å…¶ä¸­åˆå§‹åŒ–ä¸€äº›ä¸œè¥¿</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">self.template_context_processors = [_default_template_ctx_processor]</span><br><span class="line"></span><br><span class="line">        self.url_map = Map()<span class="comment">#URL endpoint function å¯¹åº”çš„map</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.static_path <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.url_map.add(Rule(self.static_path + <span class="string">'/&lt;filename&gt;'</span>,</span><br><span class="line">                                  build_only=<span class="literal">True</span>, endpoint=<span class="string">'static'</span>))</span><br><span class="line">            <span class="keyword">if</span> pkg_resources <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                target = (self.package_name, <span class="string">'static'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                target = os.path.join(self.root_path, <span class="string">'static'</span>)</span><br><span class="line">            self.wsgi_app = SharedDataMiddleware(self.wsgi_app, &#123;<span class="comment">#é™æ€</span></span><br><span class="line">                self.static_path: target</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#: the Jinja2 environment.  It is created from the</span></span><br><span class="line">        <span class="comment">#: :attr:`jinja_options` and the loader that is returned</span></span><br><span class="line">        <span class="comment">#: by the :meth:`create_jinja_loader` function.</span></span><br><span class="line">        self.jinja_env = Environment(loader=self.create_jinja_loader(),</span><br><span class="line">                                     **self.jinja_options)</span><br><span class="line">        self.jinja_env.globals.update(</span><br><span class="line">            url_for=url_for,</span><br><span class="line">            get_flashed_messages=get_flashed_messages</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè¿˜æ˜¯å¾ˆå…³é”®çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Flaskåº”ç”¨ä½¿ç”¨werkzeugåº“ä¸­çš„Mapç±»å’ŒRuleç±»æ¥å¤„ç†URLçš„æ¨¡å¼åŒ¹é…ï¼Œæ¯ä¸€ä¸ªURLæ¨¡å¼å¯¹åº”ä¸€ä¸ªRuleå®ä¾‹ï¼Œè¿™äº›Ruleå®ä¾‹æœ€ç»ˆä¼šä½œä¸ºå‚æ•°ä¼ é€’ç»™Mapç±»æ„é€ åŒ…å«æ‰€æœ‰URLæ¨¡å¼çš„ä¸€ä¸ªâ€œåœ°å›¾â€ã€‚</span><br><span class="line">Flaskä½¿ç”¨SharedDataMiddlewareæ¥å¯¹é™æ€å†…å®¹çš„è®¿é—®æ”¯æŒï¼Œä¹Ÿå³æ˜¯staticç›®å½•ä¸‹çš„èµ„æºå¯ä»¥è¢«å¤–éƒ¨ï¼Œ</span><br></pre></td></tr></table></figure>
<p>flaskçš„routeè®¾è®¡æ€è·¯ï¼Œè¿™ç¯‡è¶³ä»¥<a href="https://segmentfault.com/a/1190000004213652" target="_blank" rel="noopener">https://segmentfault.com/a/1190000004213652</a></p>
<h4 id="äºŒ-app-run"><a href="#äºŒ-app-run" class="headerlink" title="äºŒ.app.run()"></a>äºŒ.<code>app.run()</code></h4><p>å¼€å§‹è¿è¡Œflaskç±»ä¸‹çš„<code>run()</code>å‡½æ•°,runå‡½æ•°æœ€åä¸€å¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> run_simple(host, port, self, **options)<span class="comment">#å¼€å§‹è¿è¡Œ,è¿™é‡Œçš„run_simpleæ˜¯werkzeugé‡Œé¢çš„</span></span><br></pre></td></tr></table></figure>
<p>åœ¨å¯¹åº”Â·çš„<code>/lib/pythonç‰ˆæœ¬/site-packes/werkzeug/serving.py</code>æ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°è¯¥å‡½æ•°,è¯¥å‡½æ•°å±äº</p>
<p><code>class ForkingWSGIServer(ForkingMixIn, BaseWSGIServer):</code>ç±»</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_simple</span><span class="params">(hostname, port, application, use_reloader=False,</span></span></span><br><span class="line"><span class="function"><span class="params">               use_debugger=False, use_evalex=True,</span></span></span><br><span class="line"><span class="function"><span class="params">               extra_files=None, reloader_interval=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">               reloader_type=<span class="string">'auto'</span>, threaded=False,</span></span></span><br><span class="line"><span class="function"><span class="params">               processes=<span class="number">1</span>, request_handler=None, static_files=None,</span></span></span><br><span class="line"><span class="function"><span class="params">               passthrough_errors=False, ssl_context=None)</span>:</span></span><br><span class="line">    <span class="string">"""Start a WSGI application. Optional features include a reloader,</span></span><br><span class="line"><span class="string">    multithreading and fork support.</span></span><br></pre></td></tr></table></figure>
<p>è¯¥å‡½æ•°ä¸‹åŒæ—¶æ‰§è¡Œ<code>inner()</code>å‡½æ•°,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">_log(<span class="string">'info'</span>, <span class="string">' * Running on %s://%s:%d/ %s'</span>,</span><br><span class="line">         ssl_context <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">and</span> <span class="string">'http'</span> <span class="keyword">or</span> <span class="string">'https'</span>,</span><br><span class="line">         display_hostname, port, quit_msg)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        fd = int(os.environ[<span class="string">'WERKZEUG_SERVER_FD'</span>])</span><br><span class="line">    <span class="keyword">except</span> (LookupError, ValueError):</span><br><span class="line">        fd = <span class="literal">None</span></span><br><span class="line">    srv = make_server(hostname, port, application, threaded,</span><br><span class="line">                      processes, request_handler,</span><br><span class="line">                      passthrough_errors, ssl_context,</span><br><span class="line">                      fd=fd)</span><br><span class="line">    <span class="keyword">if</span> fd <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        log_startup(srv.socket)</span><br><span class="line">    srv.serve_forever()</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ‰§è¡Œäº†<code>make_server</code>,make_server()å‡½æ•°é»˜è®¤ç”Ÿæˆä¸€ä¸ªWSGIServerç±»,åŒæ—¶æœ€åä¸€å¥æ‰§è¡Œ<code>serve_forever()</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°å±äº<code>class BaseWSGIServer(HTTPServer, object):</code>ç±»ï¼Œè·Ÿè¿›</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">serve_forever</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.shutdown_signal = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        HTTPServer.serve_forever(self)</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        self.server_close()</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œ<code>HTTPServer.serve_forever(self)</code> è¿›å…¥å¯¹åº”<code>socketserver.py</code>æ–‡ä»¶è·Ÿè¿›</p>
<h4 id="ä¸‰-è¿›å…¥socketserver-py"><a href="#ä¸‰-è¿›å…¥socketserver-py" class="headerlink" title="ä¸‰.è¿›å…¥socketserver.py"></a>ä¸‰.è¿›å…¥socketserver.py</h4><hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">serve_forever</span><span class="params">(self, poll_interval=<span class="number">0.5</span>)</span>:</span></span><br><span class="line">        <span class="string">"""Handle one request at a time until shutdown.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Polls for shutdown every poll_interval seconds. Ignores</span></span><br><span class="line"><span class="string">        self.timeout. If you need to do periodic tasks, do them in</span></span><br><span class="line"><span class="string">        another thread.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.__is_shut_down.clear()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> self.__shutdown_request:</span><br><span class="line">                <span class="comment"># <span class="doctag">XXX:</span> Consider using another file descriptor or</span></span><br><span class="line">                <span class="comment"># connecting to the socket to wake this up instead of</span></span><br><span class="line">                <span class="comment"># polling. Polling reduces our responsiveness to a</span></span><br><span class="line">                <span class="comment"># shutdown request and wastes cpu at all other times.</span></span><br><span class="line">                r, w, e = _eintr_retry(select.select, [self], [], [],</span><br><span class="line">                                       poll_interval)</span><br><span class="line">                <span class="keyword">if</span> self <span class="keyword">in</span> r:</span><br><span class="line">                    self._handle_request_noblock()</span><br><span class="line"></span><br><span class="line">                self.service_actions()</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self.__shutdown_request = <span class="literal">False</span></span><br><span class="line">            self.__is_shut_down.set()</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>if self in r:self._handle_request_noblock()</code>å¦‚æœè¯·æ±‚æˆåŠŸè¿›å…¥<code>_handle_request_noblock()</code>å‡½æ•°</p>
<p>è·Ÿè¿›å¾—</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_handle_request_noblock</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""Handle one request, without blocking.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    I assume that select.select has returned that the socket is</span></span><br><span class="line"><span class="string">    readable before this function was called, so there should be</span></span><br><span class="line"><span class="string">    no risk of blocking in get_request().</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        request, client_address = self.get_request()</span><br><span class="line">    <span class="keyword">except</span> socket.error:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> self.verify_request(request, client_address):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.process_request(request, client_address)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            self.handle_error(request, client_address)</span><br><span class="line">            self.shutdown_request(request)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè°ƒç”¨<code>get_request()</code>å‡½æ•°å¾—åˆ°è¯·æ±‚ï¼Œè¿™ä¸ªå‡½æ•°ä¼špass,åŒæ—¶åé¢è°ƒç”¨äº†<code>process_request()</code>å‡½æ•°å¤„ç†è¯·æ±‚ï¼Œè·Ÿè¿›å¾—</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_request</span><span class="params">(self, request, client_address)</span>:</span></span><br><span class="line">        <span class="string">"""Call finish_request.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Overridden by ForkingMixIn and ThreadingMixIn.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.finish_request(request, client_address)</span><br><span class="line">        self.shutdown_request(request)</span><br></pre></td></tr></table></figure>
<p>å…ˆè°ƒç”¨<code>finish_request()</code>å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">finish_request</span><span class="params">(self, request, client_address)</span>:</span></span><br><span class="line">        <span class="string">"""Finish one request by instantiating RequestHandlerClass."""</span></span><br><span class="line">        self.RequestHandlerClass(request, client_address, self)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WSGIRequestHandler</span><span class="params">(BaseHTTPRequestHandler)</span>:</span>//werkzeugçš„serving.py</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseHTTPRequestHandler</span><span class="params">(socketserver.StreamRequestHandler)</span>:</span>//</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StreamRequestHandler</span><span class="params">(BaseRequestHandler)</span>:</span> ï¼ï¼socketserver.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">finish_requestæ–¹æ³•ä¸­æ‰§è¡Œäº†self.RequestHandlerClass(request, client_address, self)</span><br><span class="line">self.RequestHandlerClass = RequestHandlerClassï¼ˆå°±åœ¨__init__æ–¹æ³•ä¸­ï¼‰ã€‚æ‰€ä»¥finish_requestæ–¹æ³•æœ¬è´¨ä¸Šå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæœåŠ¡å¤„ç†å®ä¾‹,å½“æˆ‘ä»¬åˆ›å»ºæœåŠ¡å¤„ç†ç±»å®ä¾‹æ—¶ï¼Œå°±ä¼šè¿è¡Œhandle()æ–¹æ³•ï¼Œè€Œhandle()æ–¹æ³•åˆ™ä¸€èˆ¬æ˜¯æˆ‘ä»¬å¤„ç†äº‹åŠ¡é€»è¾‘çš„ä»£ç å—ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="å››-åœ¨æ­¤å›åˆ°werkzeugçš„serving-py"><a href="#å››-åœ¨æ­¤å›åˆ°werkzeugçš„serving-py" class="headerlink" title="å››.åœ¨æ­¤å›åˆ°werkzeugçš„serving.py"></a>å››.åœ¨æ­¤å›åˆ°werkzeugçš„serving.py</h4><p>è¿›å…¥werkzeugçš„handleå‡½æ•°å¾—</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Handles a request ignoring dropped connections."""</span></span><br><span class="line">        rv = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rv = BaseHTTPRequestHandler.handle(self)</span><br><span class="line">        <span class="keyword">except</span> (socket.error, socket.timeout) <span class="keyword">as</span> e:</span><br><span class="line">            self.connection_dropped(e)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">if</span> self.server.ssl_context <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="keyword">not</span> is_ssl_error():</span><br><span class="line">                <span class="keyword">raise</span></span><br><span class="line">        <span class="keyword">if</span> self.server.shutdown_signal:</span><br><span class="line">            self.initiate_shutdown()</span><br><span class="line">        <span class="keyword">return</span> rv</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨äº†<code>BaseHTTPRequestHandler.handle(self)</code>,è¿›å…¥å¾—</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></span><br><span class="line">       <span class="string">"""Handle multiple requests if necessary."""</span></span><br><span class="line">       self.close_connection = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">       self.handle_one_request()</span><br><span class="line">       <span class="keyword">while</span> <span class="keyword">not</span> self.close_connection:</span><br><span class="line">           self.handle_one_request()</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨äº†<code>handle_one_request()</code>è¯¥æ–¹æ³•é‡å†™è·³ä¸€æ­¥å›åˆ°werkzeugçš„è¯¥å‡½æ•°ä¸­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_one_request</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Handle a single HTTP request."""</span></span><br><span class="line">        self.raw_requestline = self.rfile.readline()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.raw_requestline:</span><br><span class="line">            self.close_connection = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> self.parse_request():</span><br><span class="line">            <span class="keyword">return</span> self.run_wsgi()</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨äº†<code>run_wsgi()</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°å†…éƒ¨è¿›è¡Œå†™å’Œå¼€å§‹å›å¤è¯·æ±‚ç­‰å‡½æ•°ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ª<code>execute()</code>å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">(app)</span>:</span></span><br><span class="line">            application_iter = app(environ, start_response)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">for</span> data <span class="keyword">in</span> application_iter:</span><br><span class="line">                    write(data)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> headers_sent:</span><br><span class="line">                    write(<span class="string">b''</span>)</span><br><span class="line">            <span class="keyword">finally</span>:</span><br><span class="line">                <span class="keyword">if</span> hasattr(application_iter, <span class="string">'close'</span>):</span><br><span class="line">                    application_iter.close()</span><br><span class="line">                application_iter = <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<p>executeå‡½æ•°ä¸­é€šè¿‡application_iter = app(environ, start_response)è°ƒç”¨äº†Flaskåº”ç”¨å®ä¾‹app,æœ€åå®é™…æ‰§è¡Œä¸º<code>__call__</code>å‡½æ•°ï¼Œæœ€å<code>__call__</code>å‡½æ•°ä¸Š,è¯¥å‡½æ•°æœ€åä¸€å¥ï¼Œè°ƒç”¨wsgi_appå‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> self.wsgi_app(environ, start_response)</span><br></pre></td></tr></table></figure>
<p><code>wsgi_app</code>å‡½æ•°ä¸­æœ‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å°†environå‚æ•°æ”¾å…¥request_contextä¸­å¼€å§‹åˆ›å»ºè¯·æ±‚ä¸Šä¸‹æ–‡å‡½æ•°</span></span><br><span class="line">    <span class="comment">#ä¸Šè¯‰å‡½æ•°å®é™…å³ä¸ºå‹æ ˆæ“ä½œ</span></span><br><span class="line">    <span class="keyword">with</span> self.request_context(environ):</span><br><span class="line">        rv = self.preprocess_request()<span class="comment">#é¢„å¤„ç†è¯·æ±‚</span></span><br><span class="line">        <span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            rv = self.dispatch_request()<span class="comment">#åˆ†å‘å¤„ç†è¯·æ±‚ï¼Œå¾—åˆ°å¯¹åº”ç¼–å†™å‡½æ•°çš„ç»“æœ</span></span><br><span class="line">        response = self.make_response(rv)<span class="comment">#å°†ç»“æœæŒ‡å®šåˆ°åˆ¶é€ è¿”å›çš„å‡½æ•°ä¸­</span></span><br><span class="line">        response = self.process_response(response)</span><br><span class="line">        <span class="keyword">return</span> response(environ, start_response)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­åœ¨dispatch_request()ä¸­è¿™å¥å°¤ä¸ºå…³é”®,å…¶å‡½æ•°ä¸­æœ‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> self.view_functions[endpoint](**values)<span class="comment">#é€šè¿‡endpointæ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ç„¶åå°±æ˜¯è¿è¡Œ</span></span><br></pre></td></tr></table></figure>
<h2 id="0x03-æ€»ç»“"><a href="#0x03-æ€»ç»“" class="headerlink" title="0x03.æ€»ç»“"></a>0x03.æ€»ç»“</h2><p>çœ‹ä»£ç è¿˜æ˜¯èˆ’æœğŸ˜Œï¼Œä½†æ˜¯ä¸æ’é™¤æœ‰é”™è¯¯â€¦</p>
<p><img src="http://myndtt.github.io/images/56.png" alt="ok"></p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2018/01/22/flask-v0-1æºç ç®€å•åˆ†æ/">flask v0.1æºç ç®€å•åˆ†æ</a></p>
        <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="å›åˆ°ä¸»é¡µ">myndtt</a></p>
        <p><span>å‘å¸ƒæ—¶é—´:</span>2018-01-22, 13:50:17</p>
        <p><span>æœ€åæ›´æ–°:</span>2019-09-22, 13:04:46</p>
        <p>
            <span>åŸå§‹é“¾æ¥:</span><a class="post-url" href="/2018/01/22/flask-v0-1æºç ç®€å•åˆ†æ/" title="flask v0.1æºç ç®€å•åˆ†æ">https://myndtt.github.io/2018/01/22/flask-v0-1æºç ç®€å•åˆ†æ/</a>
            <span class="copy-path" data-clipboard-text="åŸæ–‡: https://myndtt.github.io/2018/01/22/flask-v0-1æºç ç®€å•åˆ†æ/ã€€ã€€ä½œè€…: myndtt" title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2018/01/30/scrapy-æµ…åˆ†æ-ä¸€/">
                    scrapy æµ…åˆ†æ(ä¸€)
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2018/01/17/æ— é¢˜-ä¸€/">
                    æ— é¢˜ï¼ˆä¸€ï¼‰
                </a>
            </div>
        
    </nav>

  
   <!-- æ·»åŠ æ‰“èµåŠŸèƒ½ åªåœ¨æ–‡ç« è¯¦æƒ…ä¸­æ˜¾ç¤º-->
     
      
     
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-å‰è¨€"><span class="toc-number">1.</span> <span class="toc-text">0x00.å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-è·å–"><span class="toc-number">2.</span> <span class="toc-text">0x01.è·å–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-ç®€è¦åˆ†æ"><span class="toc-number">3.</span> <span class="toc-text">0x02.ç®€è¦åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-åŒ…"><span class="toc-number">3.1.</span> <span class="toc-text">1.åŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-ä¸Šä¸‹æ–‡"><span class="toc-number">3.2.</span> <span class="toc-text">2.ä¸Šä¸‹æ–‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-ç®€å•æµç¨‹"><span class="toc-number">3.3.</span> <span class="toc-text">3.ç®€å•æµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ä¸€-app-Flask-name"><span class="toc-number">3.3.1.</span> <span class="toc-text">ä¸€.app=Flask(__name__)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#äºŒ-app-run"><span class="toc-number">3.3.2.</span> <span class="toc-text">äºŒ.app.run()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä¸‰-è¿›å…¥socketserver-py"><span class="toc-number">3.3.3.</span> <span class="toc-text">ä¸‰.è¿›å…¥socketserver.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å››-åœ¨æ­¤å›åˆ°werkzeugçš„serving-py"><span class="toc-number">3.3.4.</span> <span class="toc-text">å››.åœ¨æ­¤å›åˆ°werkzeugçš„serving.py</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-æ€»ç»“"><span class="toc-number">4.</span> <span class="toc-text">0x03.æ€»ç»“</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="éšè—ç›®å½•"  title="ç‚¹å‡»æŒ‰é’®éšè—æˆ–è€…æ˜¾ç¤ºæ–‡ç« ç›®å½•">

    <script>
        yiliaConfig.toc = ["éšè—ç›®å½•", "æ˜¾ç¤ºç›®å½•", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="åˆ†äº«åˆ°æ¨ç‰¹"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="åˆ†äº«ç»™ QQ å¥½å‹"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="å¤åˆ¶ç½‘å€"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="é€šè¿‡é‚®ä»¶åˆ†äº«"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="ç”Ÿæˆæ–‡ç« äºŒç»´ç "></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"flask v0.1æºç ç®€å•åˆ†æã€€| myndtt || blogã€€","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section class="youyan" id="comments">
    <script>
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = 'http://v2.uyan.cc/code/uyan.js?uid=2148375';
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

    <div id="uyan_frame"></div>
</section>
    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2018/01/30/scrapy-æµ…åˆ†æ-ä¸€/" title="ä¸Šä¸€ç¯‡: scrapy æµ…åˆ†æ(ä¸€)">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="æ–‡ç« åˆ—è¡¨"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2018/01/17/æ— é¢˜-ä¸€/" title="ä¸‹ä¸€ç¯‡: æ— é¢˜ï¼ˆä¸€ï¼‰">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/11/21/Openstackä¹‹Novaæºä»£ç ç®€è¯»äºŒ/">Openstackä¹‹Novaæºä»£ç ç®€è¯»äºŒ</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/21/Openstackä¹‹Novaæºä»£ç ç®€è¯»ä¸€/">Openstackä¹‹Novaæºä»£ç ç®€è¯»ä¸€</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/21/Openstackä¹‹keystoneæºä»£ç ç®€è¯»ä¸€/">Openstackä¹‹keystoneæºä»£ç ç®€è¯»ä¸€</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/21/Openstackä¹‹keystoneæºä»£ç ç®€è¯»äºŒ/">Openstackä¹‹keystoneæºä»£ç ç®€è¯»äºŒ</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/09/22/Openstackä¹‹Glanceæºä»£ç ç®€è¯»ä¸€/">Openstackä¹‹Glanceæºä»£ç ç®€è¯»ä¸€</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/16/hadoop/">hadoop(ç¬”è®°)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/29/æ— é¢˜-äºŒ/">æ— é¢˜(äºŒ)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/01/scrapy-æµ…åˆ†æ-å››/">scrapy æµ…åˆ†æ(å››)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/01/scrapy-æµ…åˆ†æ-ä¸‰/">scrapy æµ…åˆ†æ(ä¸‰)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/31/scrapy-æµ…åˆ†æ-äºŒ/">scrapy æµ…åˆ†æ(äºŒ)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/30/scrapy-æµ…åˆ†æ-ä¸€/">scrapy æµ…åˆ†æ(ä¸€)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/22/flask-v0-1æºç ç®€å•åˆ†æ/">flask v0.1æºç ç®€å•åˆ†æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/17/æ— é¢˜-ä¸€/">æ— é¢˜ï¼ˆä¸€ï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/19/phpçš„sessionååºåˆ—åŒ–/">phpçš„sessionååºåˆ—åŒ–</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/07/parse-url/">parse_url</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/04/problem&solution/">problem&solution</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/14/iamsowly/">solveme.kr-iamsowly</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/09/ä¸€é“anti sql/">ä»ä¸€é“anti sqlé¢˜è®²èµ·</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/08/the-in-ubuntu/">the â€œ*â€ in ubuntu</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/07/sniperoj-web-writeup/">sniperoj some web writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/26/å‡ é“sqli/">å‡ é“sql</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/22/urlä¸­çš„ä¸‹åˆ’çº¿/">urlä¸­çš„ä¸‹åˆ’çº¿</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/20/phpä¸¤é“é¢˜/">phpä¸¤é“é¢˜</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/19/æŸå¹´æŸæœˆçš„æŸä¸€å¤©/">æŸå¹´æŸæœˆçš„æŸä¸€å¤©</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/17/å°æ¸¸æˆ 7 8 /">å°æ¸¸æˆ-7,8</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/08/å°æ¸¸æˆ 5ï¼Œ6/">å°æ¸¸æˆ5,6</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/01/å°æ¸¸æˆ 1 2 3 4/">å°æ¸¸æˆ1,2,3,4</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/29/ç»“æŸ&å¼€å§‹/">ä¸€æ®µç»“æŸ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/29/Python ç½‘æ˜“äº‘ç­¾åˆ°/">python-ç½‘æ˜“äº‘éŸ³ä¹ç­¾åˆ°ï¼Œè¯äº‘</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/26/å®éªŒå§ ctf ç¼–ç¨‹é¢˜(å…­)/">å®éªŒå§ CTF ç¼–ç¨‹é¢˜ ï¼ˆå…­ï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/24/å®éªŒå§ ctf ç¼–ç¨‹é¢˜(äº”)/">å®éªŒå§ CTF ç¼–ç¨‹é¢˜ï¼ˆäº”ï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/24/å®éªŒå§ ctf ç¼–ç¨‹é¢˜(å››)/">å®éªŒå§ CTF ç¼–ç¨‹é¢˜ï¼ˆå››ï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/23/å®éªŒå§ ctf ç¼–ç¨‹é¢˜(ä¸‰)/">å®éªŒå§ CTF ç¼–ç¨‹é¢˜ï¼ˆä¸‰ï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/23/å®éªŒå§ ctf ç¼–ç¨‹é¢˜(äºŒ)/">å®éªŒå§ CTF ç¼–ç¨‹é¢˜ï¼ˆäºŒï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/23/å®éªŒå§ ctf ç¼–ç¨‹é¢˜(ä¸€)/">å®éªŒå§ CTF ç¼–ç¨‹é¢˜ ï¼ˆä¸€ï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/22/Python-Django-åˆ«äººè½®å­ä¿®æ”¹/">python Djangoåˆ«äººçš„è½®å­ä¿®æ”¹</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/16/python-12306-æŸ¥ç¥¨/">python-12306-æŸ¥ç¥¨</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2017-2019 myndtt
            </div>
            <div class="footer-right">
                <a href="#" target="_blank" >æ²¡æœ‰ä½ çš„å¤©å ‚...</a> <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="æœ¬ç«™åˆ°è®¿æ•°"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="æœ¬é¡µé˜…è¯»é‡"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="æŸ¥çœ‹è¯„è®º"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>